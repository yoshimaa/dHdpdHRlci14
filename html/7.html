<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="robots" content="noindex,nofollow" />
  <title>プログラミングTIPS(エンジニア向け)</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #cccccc;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffcfaf; } /* Alert */
    code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #dca3a3; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #f0dfaf; } /* ControlFlow */
    code span.ch { color: #dca3a3; } /* Char */
    code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code span.co { color: #7f9f7f; } /* Comment */
    code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code span.do { color: #7f9f7f; } /* Documentation */
    code span.dt { color: #dfdfbf; } /* DataType */
    code span.dv { color: #dcdccc; } /* DecVal */
    code span.er { color: #c3bf9f; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #c0bed1; } /* Float */
    code span.fu { color: #efef8f; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
    code span.kw { color: #f0dfaf; } /* Keyword */
    code span.op { color: #f0efd0; } /* Operator */
    code span.ot { color: #efef8f; } /* Other */
    code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code span.sc { color: #dca3a3; } /* SpecialChar */
    code span.ss { color: #cc9393; } /* SpecialString */
    code span.st { color: #cc9393; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #cc9393; } /* VerbatimString */
    code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
  </style>
<!-- <script src="./theme/js/init.js"></script> -->
<!-- <link rel="stylesheet" href="./theme/css/reset.css" /> -->
  <link rel="stylesheet" href="../theme/css/base.css" />
<!-- <link rel="stylesheet" href="./theme/css/empty.css" /> -->
<link rel="stylesheet" href="../theme/css/base.css" id="themecolor" />
<!-- <link rel="stylesheet" href="./theme/css/daymode.css" />
<link rel="stylesheet" href="./theme/css/nightmode.css" /> -->
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body id="body">
  <!-- <script src="./theme/js/theme.js"></script> -->

  <header class="chapter-header">
    <div id="click-anywhere" class="lower-layer"></div>
    <div id="modal-layer"></div>
    <div id="top-menu" class="fixed">
      <div class="mobile-book-text-logo">
        <svg width="100%" height="100%" viewBox="0 0 1791 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/">
          <g transform="matrix(1,0,0,1,-51,-473)">
              <g transform="matrix(1.2249,2.20465e-34,0,1.2249,-215.908,39.3221)">
                  <g id="craft-twix-logo" transform="matrix(1,-1.09826e-50,0,1,118.292,20.3212)">
                      <g transform="matrix(1,-3.23647e-50,0,1,-373.292,67.7606)">
                          <path d="M1901.71,343.496C1901.21,343.496 1900.96,343.496 1900.96,343.746C1892.46,353.246 1866.46,376.996 1857.46,386.246C1848.21,376.746 1822.71,354.996 1810.71,344.996C1810.46,344.746 1810.21,344.746 1809.71,344.746L1809.21,344.746C1803.21,348.246 1792.96,358.496 1787.71,364.496C1787.46,364.996 1787.21,364.996 1787.21,365.246C1787.21,365.496 1787.21,365.746 1787.71,365.996C1802.96,379.996 1826.96,396.746 1836.71,406.246C1827.71,415.746 1798.21,434.746 1784.96,444.246C1784.71,444.496 1784.46,444.996 1784.46,445.496C1784.46,445.746 1784.46,445.996 1784.71,446.246C1789.46,452.496 1801.71,462.496 1809.21,468.746C1809.46,468.996 1809.96,469.246 1810.21,469.246C1810.71,469.246 1811.21,468.996 1811.46,468.746C1821.21,459.996 1841.46,442.996 1859.46,424.746C1874.21,438.996 1893.71,455.246 1906.46,468.496C1906.96,468.996 1907.71,469.746 1908.46,469.746C1908.71,469.746 1908.96,469.496 1909.21,469.496C1916.46,465.996 1928.71,452.746 1934.21,447.746C1934.46,447.496 1934.71,446.996 1934.71,446.496C1934.71,446.246 1934.71,445.996 1934.46,445.996C1920.21,434.746 1892.46,414.746 1878.21,402.996C1890.21,392.246 1914.21,377.996 1926.21,365.746C1926.71,365.246 1927.21,364.246 1927.21,363.496C1927.21,363.246 1927.21,362.996 1926.96,362.746C1919.71,355.746 1910.96,347.746 1902.46,343.496L1901.71,343.496Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-374.108,67.7606)">
                          <path d="M1764.46,350.746C1755.71,351.746 1733.21,353.496 1731.46,353.746C1730.21,353.996 1730.21,354.246 1730.21,355.246C1731.21,369.746 1731.71,383.996 1731.71,398.246C1731.71,420.496 1730.46,442.996 1728.71,465.496C1728.71,466.746 1728.96,466.746 1729.96,466.746C1736.96,466.746 1758.96,464.996 1765.21,464.496C1765.96,464.496 1766.46,463.496 1766.46,462.996C1765.46,441.496 1764.71,420.246 1764.71,398.746C1764.71,383.246 1764.96,367.496 1766.21,351.996C1766.21,351.246 1765.71,350.746 1764.96,350.746L1764.46,350.746ZM1765.71,311.746C1757.21,312.746 1732.46,314.746 1730.71,314.996C1729.46,315.246 1729.46,315.246 1729.46,316.246C1729.96,322.746 1730.21,330.996 1730.46,337.996C1730.46,339.246 1730.71,339.246 1731.71,339.246C1738.71,338.746 1758.96,336.496 1764.96,335.996C1765.96,335.996 1766.21,334.996 1766.21,334.246C1766.46,326.246 1767.46,318.996 1767.71,313.246C1767.71,312.496 1766.96,311.746 1766.21,311.746L1765.71,311.746Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-368.393,67.7606)">
                          <path d="M1705.46,354.996C1705.46,354.496 1705.21,354.246 1704.71,354.246C1697.46,352.996 1676.71,350.996 1670.46,349.996C1669.71,349.996 1669.21,350.496 1669.21,350.746C1665.46,365.246 1656.96,394.246 1654.46,407.246C1653.46,411.996 1650.71,416.746 1649.21,421.746C1646.46,415.746 1646.71,414.246 1644.71,407.496C1640.21,392.246 1630.71,366.246 1626.21,351.496C1625.96,351.246 1625.71,350.996 1625.21,350.996L1624.71,350.996C1618.96,352.246 1604.96,354.496 1594.21,355.996C1593.21,356.246 1592.71,356.996 1592.46,357.996C1588.71,372.746 1576.46,403.996 1574.96,411.246C1573.71,416.996 1571.46,422.746 1568.96,428.496C1567.71,422.496 1567.21,415.996 1566.46,411.246C1564.21,398.996 1554.21,363.496 1550.96,350.746C1550.71,349.746 1549.96,349.746 1548.46,349.746C1542.21,349.746 1525.71,352.246 1517.71,353.496C1516.96,353.746 1516.71,353.996 1516.71,354.246L1516.71,354.746C1523.71,376.246 1538.46,419.996 1544.21,437.996C1547.96,449.246 1549.21,457.496 1551.21,465.746L1551.21,465.996C1551.21,466.246 1551.46,466.496 1552.46,466.496C1560.46,466.246 1578.71,463.746 1584.71,463.246L1585.71,463.246C1585.71,463.246 1585.96,462.996 1585.96,462.746C1590.71,448.246 1602.21,422.246 1605.96,409.996C1607.46,404.996 1608.46,398.996 1610.21,395.246C1611.46,397.996 1613.21,407.246 1614.21,410.246C1620.46,428.496 1629.71,452.496 1632.46,463.996C1632.71,464.996 1633.71,466.246 1635.46,466.246C1643.71,465.996 1657.21,464.746 1664.96,464.496C1665.96,464.496 1666.46,463.496 1666.71,462.996C1668.71,455.246 1671.71,446.496 1676.21,435.496C1682.21,420.746 1698.21,373.746 1705.46,355.496L1705.46,354.996Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-369.21,67.7606)">
                          <path d="M1389.71,467.996C1397.96,467.996 1417.71,466.496 1423.46,465.996C1424.21,465.996 1424.71,464.746 1424.71,464.246C1423.71,442.996 1423.21,421.746 1423.21,400.496C1423.21,380.496 1423.71,360.746 1424.71,340.746C1452.96,341.746 1466.96,343.496 1484.46,347.246C1485.21,347.246 1485.71,347.496 1486.46,347.496C1486.96,347.496 1487.71,347.246 1488.71,346.246C1494.96,339.746 1496.46,326.746 1500.21,316.496L1500.21,315.996C1500.21,314.996 1499.21,314.246 1497.96,314.246L1490.46,314.246C1455.46,314.246 1420.71,312.246 1385.71,312.246C1366.46,312.246 1347.46,312.996 1328.21,314.746C1326.71,314.996 1325.96,316.746 1325.46,318.496C1324.71,321.496 1318.21,341.996 1317.46,343.746C1317.21,344.246 1317.21,344.496 1317.21,344.996C1317.21,345.746 1317.71,345.996 1318.71,345.996L1319.46,345.996C1340.46,341.746 1361.96,340.246 1390.96,339.996C1391.21,348.246 1391.21,356.746 1391.21,365.496C1391.21,399.246 1389.96,434.496 1386.96,466.996L1386.96,467.496C1386.96,467.996 1387.21,467.996 1387.46,467.996L1389.71,467.996Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-341.452,67.7606)">
                          <path d="M1219.21,437.496C1219.21,436.496 1218.46,435.996 1217.46,435.996C1211.71,436.746 1206.46,436.996 1201.96,436.996C1183.46,436.996 1172.46,431.496 1172.46,419.496L1172.46,418.746C1172.71,411.996 1172.71,394.746 1173.21,376.746C1192.71,376.746 1208.96,376.996 1213.71,377.996L1214.21,377.996C1214.96,377.996 1216.21,377.496 1217.21,375.996C1221.21,369.996 1222.46,357.496 1224.46,351.996L1224.46,351.746C1224.46,350.996 1223.71,350.246 1222.96,350.246L1173.71,350.246C1174.46,328.746 1174.96,315.496 1175.21,312.746C1175.21,311.996 1175.21,311.996 1174.71,311.996L1173.96,311.996C1164.71,313.246 1150.46,313.996 1140.21,315.246C1139.46,315.496 1138.71,315.746 1138.71,316.496L1138.71,316.996C1139.46,324.746 1139.96,334.246 1140.21,350.746C1121.46,351.246 1105.96,351.746 1102.21,351.996C1101.21,352.246 1100.46,352.746 1100.21,353.496C1098.71,356.996 1094.96,369.996 1092.71,377.746L1092.71,378.496C1092.71,379.246 1092.96,379.496 1093.71,379.496L1094.21,379.496C1101.71,378.996 1119.96,377.996 1140.21,377.496C1140.21,386.996 1140.46,393.496 1140.46,400.246C1140.46,405.246 1140.21,410.496 1139.96,416.996L1139.96,421.496C1139.96,457.496 1161.21,466.996 1206.71,469.746C1207.96,469.746 1208.96,468.996 1209.21,468.246C1213.21,457.996 1217.71,446.496 1219.21,437.996L1219.21,437.496Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-346.351,67.7606)">
                          <path d="M1070.21,393.746C1071.21,393.746 1072.21,393.246 1073.21,391.746C1077.21,385.746 1077.71,372.996 1079.71,367.496L1079.71,367.246C1079.71,366.496 1078.96,365.746 1078.21,365.746C1071.96,365.496 1047.21,365.246 1021.96,364.996C1022.21,357.746 1022.21,354.746 1022.21,353.496C1022.21,345.746 1037.71,340.496 1059.71,340.496C1063.21,340.496 1066.96,340.746 1070.71,340.996C1071.71,340.996 1072.21,340.496 1072.21,339.496C1070.21,328.746 1067.21,315.246 1065.71,310.496C1065.21,309.496 1064.96,309.496 1063.71,309.496C1024.21,309.996 992.458,321.996 992.458,345.746C992.458,350.246 992.208,355.246 991.958,364.746C975.958,364.746 963.208,364.996 959.708,365.246C958.958,365.246 958.208,365.996 957.958,366.746C956.458,370.496 954.208,383.246 950.958,391.246C950.958,391.496 950.708,391.746 950.708,391.996C950.708,392.746 951.208,392.996 952.208,392.996L952.708,392.996C959.208,392.496 973.958,391.996 990.708,391.746C989.458,418.996 987.708,447.746 986.208,464.996C986.208,466.246 986.458,466.246 987.708,466.246C994.458,466.246 1015.71,464.496 1021.71,463.996C1022.71,463.996 1023.21,462.996 1023.21,462.496C1022.21,436.746 1021.71,408.746 1021.71,391.746C1044.21,391.746 1064.21,392.496 1069.71,393.746L1070.21,393.746Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-348.8,67.7606)">
                          <path d="M852.958,441.496C835.708,440.746 818.708,432.746 817.958,412.496L817.958,411.246C817.958,392.246 835.708,378.996 853.208,378.996C865.458,378.996 875.458,383.496 880.708,392.746C880.958,393.246 881.208,393.746 881.708,393.746C882.208,393.746 882.458,393.496 883.208,392.996C883.958,392.496 893.458,379.246 893.958,379.246C893.958,388.246 893.958,406.746 893.458,424.496C884.708,435.246 870.208,441.496 855.458,441.496L852.958,441.496ZM851.208,470.246C871.208,469.996 884.208,465.746 891.708,459.496C893.458,465.246 899.708,470.246 907.958,474.246C908.458,474.496 909.458,474.496 910.458,474.496C911.458,474.496 912.458,474.496 912.958,474.246C920.708,469.496 931.708,458.496 937.208,449.996C937.458,449.496 937.458,449.246 937.458,448.996C937.458,448.746 937.458,448.746 936.958,448.496C928.708,445.746 923.958,443.996 923.708,438.246C922.958,425.496 922.708,410.996 922.708,397.996C922.708,386.496 922.958,376.246 923.458,369.496C923.708,366.996 926.208,356.746 927.958,346.496C927.958,345.746 926.708,344.996 925.958,344.996L896.708,344.996C895.458,344.996 895.208,346.496 894.958,347.496C894.208,350.746 894.458,355.246 893.458,362.496C887.458,355.996 871.708,349.496 857.208,349.496C855.958,349.496 854.708,349.746 853.458,349.746C815.708,352.496 784.208,375.746 784.208,412.996C784.208,446.246 816.708,470.246 850.708,470.246L851.208,470.246Z"/>
                      </g>
                      <g transform="matrix(1,-3.23647e-50,0,1,-352.065,67.7606)">
                          <path d="M771.958,359.746C771.958,359.246 771.458,358.996 770.708,358.746C756.208,356.246 738.958,350.996 718.458,350.996C714.208,350.996 709.958,351.246 705.458,351.746C694.708,352.996 679.458,362.746 673.458,369.746C673.708,364.496 674.458,357.496 674.958,352.246C674.958,351.246 674.208,350.746 672.958,350.746C664.208,351.246 643.458,352.246 639.708,352.996C638.458,353.246 638.458,353.496 638.458,354.246C639.708,372.996 640.458,390.996 640.458,408.996C640.458,427.746 639.708,446.246 637.958,465.746C637.958,466.746 638.208,466.746 638.458,466.746L640.708,466.746C648.708,466.746 668.958,464.996 674.708,464.746C675.708,464.496 676.208,463.496 676.208,462.996C674.458,441.246 671.708,419.246 671.708,397.496C671.708,392.746 671.958,388.246 672.208,383.496C674.208,386.246 679.458,391.996 680.958,393.746C681.708,394.496 682.208,394.996 682.708,394.996C683.208,394.996 683.708,394.746 683.958,393.996C688.208,385.496 694.708,379.746 706.458,379.246L708.458,379.246C725.958,379.246 743.958,389.246 753.458,393.496C753.708,393.746 753.958,393.746 754.458,393.746C755.208,393.746 756.458,393.246 757.208,392.246C762.708,384.496 768.708,367.746 771.958,360.246L771.958,359.746Z"/>
                      </g>
                      <g transform="matrix(1,-1.09826e-50,0,1,-351.249,67.7606)">
                          <path d="M619.708,335.246C619.708,334.996 619.458,334.996 619.208,334.746C598.958,319.746 574.208,308.996 548.708,308.996C498.958,308.996 451.208,336.496 451.208,391.246C451.208,448.496 498.208,470.496 549.208,470.496C560.708,470.496 614.708,461.246 616.708,446.996C616.958,445.746 616.958,443.996 616.958,441.996C616.958,434.246 615.958,421.746 614.708,416.996C614.458,416.246 613.958,414.746 612.708,414.746C612.458,414.746 612.208,414.746 611.958,414.996C597.958,428.496 578.208,441.746 548.208,441.746C515.958,441.746 486.708,428.246 486.708,391.996C486.708,359.246 514.958,340.996 545.208,340.246L547.208,340.246C570.458,340.246 582.208,348.746 599.208,362.996C599.458,363.246 599.708,363.246 599.958,363.246C600.208,363.246 600.458,363.246 600.708,362.996C607.958,356.746 615.958,344.746 619.708,335.746L619.708,335.246Z"/>
                      </g>
                      <g transform="matrix(1,-1.09826e-50,0,1,-118.292,-20.3212)">
                          <path d="M278.995,458.606L288.553,448.074L326.504,481.104L315.809,492.762L278.995,458.606Z"/>
                          <path d="M299.35,487.517L304.962,493.268L350.311,446.245L345.4,441.342L299.35,487.517Z"/>
                      </g>
                      <g transform="matrix(1,-1.09826e-50,0,1,-139.719,-12.3954)">
                          <path d="M1106.17,420.885C1116.49,435.805 1145.44,448.276 1169.07,448.276C1198.58,448.275 1213.9,445.318 1231.62,431.134C1249.34,416.95 1240.42,411.321 1226.49,417.914C1212.57,424.506 1184.06,438.168 1167.27,435.761C1130.79,430.531 1132.32,427.004 1118.44,413.876C1113.59,409.28 1098.26,409.426 1106.17,420.885Z"/>
                      </g>
                      <g transform="matrix(0.729955,-5.75219e-51,0,0.729955,206.372,75.0805)">
                          <g transform="matrix(1.19281,0,0,1.19281,-222.377,-41.9313)">
                              <path d="M1148.83,368.044L1120.01,379.244C1120.01,379.244 1121.85,391.936 1135.49,397.102C1155.02,404.505 1184.42,396.732 1191.41,378.697C1193.85,372.405 1148.83,368.044 1148.83,368.044Z"/>
                          </g>
                          <g transform="matrix(1.19281,0,0,1.19281,-140.339,-36.8696)">
                              <circle cx="1101.52" cy="356.45" r="27.447"/>
                          </g>
                          <g transform="matrix(1,0,0,1,-17.2449,0.229812)">
                              <path d="M1209.28,364.935C1210.48,365.218 1236.63,358.739 1239.43,355.241C1241.87,352.198 1229.11,372.937 1222.19,377.912C1219.74,379.669 1234.99,375.799 1243.12,372.929C1244.34,372.497 1228.97,389.774 1223.91,394.669C1221.58,396.918 1208.08,364.651 1209.28,364.935Z"/>
                          </g>
                      </g>
                  </g>
              </g>
          </g>
        </svg>
      </div>
      <!--         <div class="title-mobile">プログラミングTIPS(エンジニア向け)</div>
       -->
    </div>
    <div id="bottom-menu" class="fixed">
      <div class="mobiletab-wrap">
        <input id="mobiletab-a" type="radio" name="mobiletab" class="tab-switch" checked="checked" />
        <input id="mobiletab-b" type="radio" name="mobiletab" class="tab-switch" />
        <input id="mobiletab-c" type="radio" name="mobiletab" class="tab-switch" />
        <input id="mobiletab-d" type="radio" name="mobiletab" class="tab-switch" />
        <input id="mobiletab-e" type="radio" name="mobiletab" class="tab-switch" />
    
        <div class="mobiletab-item-wrap">
            <label class="mobiletab-label mobiletab-label-a" for="mobiletab-a">Close</label>
            <label class="mobiletab-label mobiletab-label-b" for="mobiletab-b">Toc</label>
            <label class="mobiletab-label mobiletab-label-c" for="mobiletab-c">Chapter</label>
            <label class="mobiletab-label mobiletab-label-d" for="mobiletab-d">News</label>
            <label class="mobiletab-label mobiletab-label-e" for="mobiletab-e">Setting</label>
        </div>
      </div>
      <div class="mobiletab-content-wrap">
        <div id="mobiletab-content-a" class="mobiletab-content">
          <div class="mobiletab-content-layout">
          </div>
        </div>
        <div id="mobiletab-content-b" class="mobiletab-content">
            <div class="mobiletab-content-layout toc-menu">
              <a id="pageTop" href="#"><div class="pagetop-btn">Page Top</div></a>
              <!-- <div id="indexList2"> -->
              <div id="indexList">
                <nav id="TOC" class="index" role="doc-toc">
                  <ul>
                  <li><a href="#最初に" id="toc-最初に">最初に</a></li>
                  <li><a href="#ファイル解説"
                  id="toc-ファイル解説">ファイル解説</a>
                  <ul>
                  <li><a href="#debug-utils.js"
                  id="toc-debug-utils.js">debug-utils.js</a></li>
                  <li><a href="#spreadsheet-helpers.js"
                  id="toc-spreadsheet-helpers.js">spreadsheet-helpers.js</a></li>
                  <li><a href="#menu.js"
                  id="toc-menu.js">menu.js</a></li>
                  <li><a href="#tweet.js"
                  id="toc-tweet.js">tweet.js</a></li>
                  <li><a href="#fetch-wp-posts.js"
                  id="toc-fetch-wp-posts.js">fetch-wp-posts.js</a></li>
                  <li><a href="#fetch-wp-categories.js"
                  id="toc-fetch-wp-categories.js">fetch-wp-categories.js</a></li>
                  </ul></li>
                  <li><a href="#開発環境"
                  id="toc-開発環境">開発環境</a></li>
                  <li><a href="#トラブルシューティング"
                  id="toc-トラブルシューティング">トラブルシューティング</a>
                  <ul>
                  <li><a href="#読み取り専用エディタは編集できません"
                  id="toc-読み取り専用エディタは編集できません">読み取り専用エディタは編集できません</a></li>
                  </ul></li>
                  <li><a href="#プログラミング解説"
                  id="toc-プログラミング解説">プログラミング解説</a>
                  <ul>
                  <li><a href="#文字数のカウント"
                  id="toc-文字数のカウント">文字数のカウント</a></li>
                  <li><a href="#画像投稿1枚のサンプル"
                  id="toc-画像投稿1枚のサンプル">画像投稿1枚のサンプル</a></li>
                  <li><a href="#ツリー投稿のサンプル"
                  id="toc-ツリー投稿のサンプル">ツリー投稿のサンプル</a></li>
                  <li><a href="#日付一括変換機能の実装事例"
                  id="toc-日付一括変換機能の実装事例">「日付一括変換」機能の実装事例</a></li>
                  </ul></li>
                  <li><a href="#最後に" id="toc-最後に">最後に</a>
                  <ul>
                  <li><a href="#初心者すぎてコードがわからない"
                  id="toc-初心者すぎてコードがわからない">初心者すぎてコードがわからない</a></li>
                  <li><a href="#バグ報告歓迎"
                  id="toc-バグ報告歓迎">バグ報告歓迎</a></li>
                  </ul></li>
                  </ul>
                </nav>
              </div>
            </div>
        </div>
        <div id="mobiletab-content-c" class="mobiletab-content">
            <div class="mobiletab-content-layout toc-menu">
              <div class="chapter-toc">
                <ul>
                  <li><a href="./1-twitter-api.html">Twitter APIの取得</a></li>
                  <li><a href="./2-crafttwix-usage.html">Craft Twixの使い方(予約投稿編)</a></li>
                  <li><a href="./3-crafttwix-usage-images-videos.html">Craft Twixの使い方(画像・動画管理編)</a></li>
                  <li><a href="./4-wp-api.html">WordPress APIの取得</a></li>
                  <li><a href="./5-crafttwix-usage-for-wp.html">Craft Twixの使い方(WordPress編)</a></li>
                  <li><a href="./6-spreadsheet-tips.html">スプレットシートの使い方TIPS(ノンプログラマー向け)</a></li>
                  <li><a href="./7-program-tips.html">プログラミングTIPS(エンジニア向け)</a></li>
                  <li><a href="./8-colophon.html">あとがき</a></li>
                </ul>
              </div>
            </div>
        </div>
        <div id="mobiletab-content-d" class="mobiletab-content">
          <div class="mobiletab-content-layout">
            <div class="sidebar-menu-link">
              <a href="https://ebookbrain.booth.pm/items/4941730">
                <div class="square-btn">
                  Update
                </div>
              </a>
              <a href="https://ebookbrain.net/ebook-and-tool-collection-available-on-ebookbrain/">
                <div class="square-btn">
                  News
                </div>
              </a>
            </div> 
          </div>
        </div>
        <div id="mobiletab-content-e" class="mobiletab-content">
          <div class="mobiletab-content-layout">
            <!-- <div>
              <input type="button" id="set-day-theme-mobile" onclick="changeDaymode();" value="">
              <input type="button" id="set-night-theme-mobile" onclick="changeDarkmode();" value="">
              <input type="button" id="set-sepia-theme-mobile" onclick="changeSepiamode();" value="">
            </div> -->
            <nav>
              <ul class="color-menu color-menu-mobile">
                <li>
                  <label for="set-day-theme-mobile">
                    <input type="checkbox" id="set-day-theme-mobile" onclick="changeDaymode();" value="">
                    <div class="icon-btn">
                      <div>
                        <svg x="50%" y="50%" width="75%" height="75%" viewBox="0 0 600 600">
                          <defs>
                            <lineargradient id="dayBtnGradient" gradientTransform="rotate(45)">
                              <stop offset="5%"  stop-color="#f8d661"></stop>
                              <stop offset="95%" stop-color="#e56376"></stop>
                            </lineargradient>
                          </defs>
                          <g transform="matrix(1,0,0,1,-7374,-2500)" fill="url('#dayBtnGradient')">
                              <g transform="matrix(1,0,0,1,-0.0555556,0)">
                                  <g transform="matrix(1.15385,0,0,1.15385,-1238.25,-419.231)">
                                      <circle cx="7724" cy="2790" r="130"/>
                                  </g>
                                  <g>
                                      <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                  </g>
                                  <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4874.06)">
                                      <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                  </g>
                                  <g transform="matrix(-1,-1.22465e-16,1.22465e-16,-1,15348.1,5600)">
                                      <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                  </g>
                                  <g transform="matrix(6.12323e-17,-1,1,6.12323e-17,4874.06,10474.1)">
                                      <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                      <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                          <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                      </g>
                                  </g>
                              </g>
                          </g>
                        </svg>  
                      </div>
                    </div>
                    <div>
                      Day
                    </div>
                  </label>
                </li>
                <li>
                  <label for="set-night-theme-mobile">
                    <input type="checkbox" id="set-night-theme-mobile" onclick="changeDarkmode();" value="">
                    <div class="icon-btn"><div>
                    <svg x="50%" y="50%" width="75%" height="75%" viewBox="0 0 579 550">
                      <defs>
                        <lineargradient id="nightBtnGradient" gradientTransform="rotate(45)">
                          <stop offset="5%"  stop-color="#6275e0"></stop>
                          <stop offset="95%" stop-color="#6e51A4"></stop>
                        </lineargradient>
                      </defs>
                      <g transform="matrix(1,0,0,1,-6681,-2529)" fill="url('#nightBtnGradient')">
                        <g transform="matrix(1,0,0,1,-0.0555556,0)">
                          <g transform="matrix(1.11529,0,0,1.11529,-917.771,-209.044)">
                            <path d="M7072.5,2455L7170.81,2592.19L7331.66,2643.29L7231.57,2779.18L7232.67,2947.96L7072.5,2894.75L6912.33,2947.96L6913.43,2779.18L6813.34,2643.29L6974.19,2592.19L7072.5,2455Z"/>
                          </g>
                        </g>
                      </g>
                    </svg>  
                    </div></div>
                    <div>
                      Night
                    </div>
                  </label>
                </li>
                <li>
                  <label for="set-sepia-theme-mobile">
                    <input type="checkbox" id="set-sepia-theme-mobile" onclick="changeSepiamode();" value="">
                    <div class="icon-btn"><div>
                      <svg x="50%" y="50%" width="75%" height="75%" viewBox="0 0 635 600">
                        <defs>
                          <lineargradient id="memoryBtnGradient" gradientTransform="rotate(45)">
                            <stop offset="5%"  stop-color="#dac96d"></stop>
                            <stop offset="95%" stop-color="#f3eacb"></stop>
                          </lineargradient>
                        </defs>
                        <g transform="matrix(1,0,0,1,-8139,-2500)">
                            <g transform="matrix(1,0,0,1,-0.0555556,0)" fill="url('#memoryBtnGradient')">
                                <g transform="matrix(-0.01406,0.123333,-1.93818,-0.220953,14953,2598.21)">
                                    <path d="M7374,3433.61L7374,3425.39L7661.21,3425.39L7661.21,3400L8274,3429.5L7661.21,3459L7661.21,3433.61L7374,3433.61Z"/>
                                </g>
                                <g transform="matrix(-0.708237,-0.705975,0.705975,-0.708237,12004.7,11261.3)">
                                    <path d="M8548.67,3209.44C8524.27,3203.17 8499.19,3200 8474,3200C8308.42,3200 8174,3334.43 8174,3500C8174,3665.58 8308.42,3800 8474,3800C8639.58,3800 8774,3665.58 8774,3500C8774,3420.43 8742.39,3344.13 8686.13,3287.87L8651.57,3322.43C8698.66,3369.53 8725.12,3433.4 8725.12,3500C8725.12,3638.6 8612.6,3751.12 8474,3751.12C8335.4,3751.12 8222.88,3638.6 8222.88,3500C8222.88,3361.4 8335.4,3248.88 8474,3248.88C8495.08,3248.88 8516.08,3251.54 8536.5,3256.78L8548.67,3209.44Z"/>
                                </g>
                                <g transform="matrix(1,0,1.2326e-32,1.5,767.056,-1150.5)">
                                    <path d="M7734,2510C7734,2504.48 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2504.48 7674,2510L7674,2610C7674,2615.52 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2615.52 7734,2610L7734,2510Z"/>
                                </g>
                                <g transform="matrix(-0.551323,0.834292,-1.25144,-0.826985,16039.3,-1441.44)">
                                    <path d="M7734,2510C7734,2504.48 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2504.48 7674,2510L7674,2610C7674,2615.52 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2615.52 7734,2610L7734,2510Z"/>
                                </g>
                            </g>
                        </g>
                      </svg>  
                    </div></div>
                    <div>
                      Sepia
                    </div>
                  </label>
                </li>
              </ul>
            </nav> 
          </div>
        </div>
      </div>
    </div>
  </header>

    <!-- <div class="arch-header"> -->
      <!-- <img class="eyecatch" src="./theme/book-images/icatch.jpg" alt=""> -->
    <div class="header">
      <div class="stripe "></div>
              <h1 class="title">
          プログラミングTIPS(エンジニア向け)
        </h1>
                </div>
    <div class="columns-contenter">
      <div id="main-content-div" class="main-content">
        <h2 id="最初に">最初に</h2>
        <p>この章はプログラミングに興味があり、カスタマイズをしたい人やエンジニア初心者、JavaScriptのプログラムがわかる方を対象としています。ノンプログラマーの方には少し難しい内容でしょうから、読み飛ばしてもらってかまいません。</p>
        <p>このツールは転売や転載をしないことを条件に、改変は自由です。よって、ご自身で追加機能を実装したり、コードを修正したりしても全く問題ありません。個人・法人を問いません。</p>
        <p>ただし、この解説はプログラミングの教材ではないため、説明は最低限に留めています。おまけ扱いでご理解いただければ幸いです。</p>
        <p>GASのスクリプトは次の手順で確認できます。</p>
        <p><span class="marker">拡張機能 &gt; Apps Script</span></p>
        <p>各ファイルについて簡単に解説します。</p>
        <h2 id="ファイル解説">ファイル解説</h2>
        <h3 id="debug-utils.js">debug-utils.js</h3>
        <p>デバッグログの設計は簡単なもので、console.log()はデフォルトで非表示にしています。</p>
        <p>次の関数を実行すると表示できます。<br />
        <code>enableDebugMode</code></p>
        <p>次の関数を実行すると非表示に戻せます。<br />
        <code>disableDebugMode</code></p>
        <p>console.error()はログの切り分けをしていないため、リリース環境でもログが表示されます。</p>
        <h3 id="spreadsheet-helpers.js">spreadsheet-helpers.js</h3>
        <p>スプレッドシート用の簡易スクリプトです。</p>
        <p>開発環境と本番環境はもちろん分けて開発しています。リリース環境のスプレッドシートIDを入れると、開発環境から本番環境にスプレッドシートをコピーする関数を用意しています。</p>
        <h3 id="menu.js">menu.js</h3>
        <p>Googleスプレッドシートのメニューに関するコードが書かれています。Googleドライブのサーバーサイドの処理も含まれます。</p>
        <h3 id="tweet.js">tweet.js</h3>
        <p>メインです。<br />
        トリガーの登録や削除などスケジュール管理、ポスト、画像投稿、動画投稿、ツリー投稿などに関するコードを書かれています。</p>
        <p>現状、画像投稿と動画投稿はAPI
        1.1でメディアをアップロードし、API
        v2で投稿しています。ツリー投稿はv2のみでできます。</p>
        <h3 id="fetch-wp-posts.js">fetch-wp-posts.js</h3>
        <p>WordPressの記事を取得するコードが書かれています。<br />
        少し工夫した点としてパフォーマンスを改善するため、単一のリクエストを行うUrlFetchApp.fetchの代わりに、複数のリクエストを同時に行えるUrlFetchApp.fetchAllを使用してみました。</p>
        <h3 id="fetch-wp-categories.js">fetch-wp-categories.js</h3>
        <p>WordPressのカテゴリを取得するコードが書かれています。</p>
        <h2 id="開発環境">開発環境</h2>
        <p>GASのエディタに直接コードを書いたのは初期の頃だけです。その後は開発環境と本番環境をわけてVsCodeで開発しました。</p>
        <p>この過程でGoogleが提供するGASをローカル環境で開発できるCLIツール「clasp」を使いました。「clasp」は簡単に導入できて、ほとんど問題が発生しなかったため、よい選択肢ではないでしょうか。</p>
        <ul>
        <li><a href="https://github.com/google/clasp">clasp</a></li>
        </ul>
        <h2 id="トラブルシューティング">トラブルシューティング</h2>
        <h3
        id="読み取り専用エディタは編集できません">読み取り専用エディタは編集できません</h3>
        <p>スクリプトが編集できない場合、再度立ち上げると解消されます。</p>
        <h2 id="プログラミング解説">プログラミング解説</h2>
        <h3 id="文字数のカウント">文字数のカウント</h3>
        <p>おまけで、文字数のカウントについて簡単に解説させてもらいます。</p>
        <div class="code-with-filename lang-text">
        <p>スプレッドシート</p>
        <div class="sourceCode" id="cb1"
        data-filename="スプレッドシート"><pre
        class="sourceCode text:スプレッドシート.txt lang-text"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>=LENB(A1) - LEN(A1) + LEN(REGEXREPLACE(A1, &quot;https?://[^\s]*&quot;, &quot;xxxxxxxxxxxxxxxxxxxxxxx&quot;))</span></code></pre></div>
        </div>
        <p><code>LENB(A1) - LEN(A1)</code>：LENBは、半角文字を1バイト、全角文字を2バイトとしてカウントします。LENは、半角も全角も1文字としてカウントされます。引き算すると全角文字の数を特定することができます。</p>
        <p>この計算式は、日本語や絵文字などの非ASCII文字の数を求めています。ただし注意すべきは、一部の絵文字は4文字としてカウントされますが、X(Twitter)はこれらを2文字としてカウントします。この問題はGAS(JavaScript)等の関数を使っても完全に吸収することが難しかったため、現状では文字数が多めにカウントされるという仕様となっています。しかし、文字数が上限を超えることはないため大きな問題にはなりません。</p>
        <p><code>LEN(REGEXREPLACE(A1, "https?://[^\s]*", "xxxxxxxxxxxxxxxxxxxxxxx"))</code>：この部分ではURLを”xxxxxxxxxxxxxxxxxxxxxxx”（23文字）に置き換え、その結果の文字数を求めています。以前、他の方法で実装したことがありますが、この方法はとても簡単に記述できます。</p>
        <div class="code-with-filename lang-text">
        <p>スプレッドシート</p>
        <div class="sourceCode" id="cb2"
        data-filename="スプレッドシート"><pre
        class="sourceCode text:スプレッドシート.txt lang-text"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>=ARRAYFORMULA(IF(LEN(I3:I), LENB(I3:I) - LEN(I3:I) + LEN(REGEXREPLACE(I3:I, &quot;https?://[^\s]*&quot;, &quot;xxxxxxxxxxxxxxxxxxxxxxx&quot;)), ))</span></code></pre></div>
        </div>
        <p>ARRAYFORMULAは1つのセルに計算式を入力すると、その数式の結果が指定した範囲全体に反映されます。これにより、セルのコピー&amp;ペーストやドラッグ&amp;ドロップを行わなくても済むので、操作ミスを減らすことができます。行や列、または任意のセル範囲に対しても使用することができます。この関数はGoogleスプレッドシート特有のものです。</p>
        <p>なお、セルが未入力の場合は結果を空欄としています。ARRAYFORMULAを利用すると、未入力を0とすると、指定した列全体が0で埋められてしまうためです。</p>
        <h3 id="画像投稿1枚のサンプル">画像投稿1枚のサンプル</h3>
        <p>1枚だけ画像投稿するためのサンプルコードです。</p>
        <p>現状、画像投稿と動画投稿はAPI
        1.1でメディアをアップロードし、API v2で投稿しています。API
        v1とv2の連携や、media_idsの指定方法について悩む人が多いかもしれません。</p>
        <div class="code-with-filename lang-js">
        <p>tweet.gs</p>
        <div class="sourceCode" id="cb3" data-filename="tweet.gs"><pre
        class="sourceCode js:tweet.gs lang-js"><code class="sourceCode glsl"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 画像1枚投稿</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>function <span class="fu">tweetWithImage</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 画像URL</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> imageUrl <span class="op">=</span> &#39;https<span class="op">:</span><span class="co">//xxx.com/wp-content/uploads/images/test.png&#39;;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 画像のBlobデータを取得</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> imageBlob <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span><span class="op">(</span>imageUrl<span class="op">).</span><span class="fu">getBlob</span><span class="op">();</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// OAuth1.0 Service</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> oauth1Service <span class="op">=</span> <span class="fu">getService1</span><span class="op">();</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 画像アップロードのURL</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> uploadUrl <span class="op">=</span> &#39;https<span class="op">:</span><span class="co">//upload.twitter.com/1.1/media/upload.json&#39;;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 画像アップロードのPayload</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> payload <span class="op">=</span> <span class="op">{</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    media_data<span class="op">:</span> Utilities<span class="op">.</span><span class="fu">base64Encode</span><span class="op">(</span>imageBlob<span class="op">.</span><span class="fu">getBytes</span><span class="op">())</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 画像アップロードのオプション</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> options <span class="op">=</span> <span class="op">{</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    method<span class="op">:</span> &#39;POST&#39;<span class="op">,</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    payload<span class="op">:</span> payload<span class="op">,</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    muteHttpExceptions<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 画像アップロードリクエスト</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> response <span class="op">=</span> oauth1Service<span class="op">.</span><span class="fu">fetch</span><span class="op">(</span>uploadUrl<span class="op">,</span> options<span class="op">);</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> mediaId <span class="op">=</span> JSON<span class="op">.</span><span class="fu">parse</span><span class="op">(</span>response<span class="op">.</span><span class="fu">getContentText</span><span class="op">()).</span><span class="fu">media_id_string</span><span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  console<span class="op">.</span><span class="fu">log</span><span class="op">(</span>&#39;mediaId&#39;<span class="op">,</span> mediaId<span class="op">)</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">// OAuth2.0認証情報</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> oauth2Service <span class="op">=</span> <span class="fu">getService2</span><span class="op">();</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 投稿のURL</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> endpoint2 <span class="op">=</span> &#39;https<span class="op">:</span><span class="co">//api.twitter.com/2/tweets&#39;;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 投稿のPayload</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> tweetPayload <span class="op">=</span> JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">({</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    &#39;text&#39;<span class="op">:</span> &#39;Craft Twix<span class="op">!</span>&#39;<span class="op">,</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    &#39;media&#39;<span class="op">:</span> <span class="op">{</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>      &#39;media_ids&#39;<span class="op">:</span> <span class="op">[</span>mediaId<span class="op">]</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="op">});</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 投稿のオプション</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> tweetOptions <span class="op">=</span> <span class="op">{</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    method<span class="op">:</span> &#39;POST&#39;<span class="op">,</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">:</span> <span class="op">{</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>      Authorization<span class="op">:</span> &#39;Bearer &#39; <span class="op">+</span> oauth2Service<span class="op">.</span><span class="fu">getAccessToken</span><span class="op">(),</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>      &#39;Content<span class="op">-</span>Type&#39;<span class="op">:</span> &#39;application<span class="op">/</span>json&#39;</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">},</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    payload<span class="op">:</span> tweetPayload<span class="op">,</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    muteHttpExceptions<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 投稿投稿リクエスト</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> tweetResponse <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span><span class="op">(</span>endpoint2<span class="op">,</span> tweetOptions<span class="op">);</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">// レスポンスをログに出力</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  console<span class="op">.</span><span class="fu">log</span><span class="op">(</span>tweetResponse<span class="op">.</span><span class="fu">getContentText</span><span class="op">());</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
        </div>
        <p>次の手順に従ってテストを実施できます。</p>
        <ol type="1">
        <li><code>tweetWithImage</code>という関数をGASにコピー＆ペーストします。</li>
        <li><code>imageUrl</code>を、投稿したい画像のURLに書き換えます。</li>
        <li>GAS上で、実行ログの左隣にあるドロップダウンメニューから関数を選択し、<code>実行</code>ボタンをクリックします。</li>
        </ol>
        <h3 id="ツリー投稿のサンプル">ツリー投稿のサンプル</h3>
        <p>ツリー投稿には、Ver1とVer2のAPIのどちらを使うのか、あるいは英文ドキュメントを見ても、それっぽい記述がいくつかあり、どれを使うべきか疑問に思うかもしれません。</p>
        <p>簡単なサンプルを提示するとこうなりますね。</p>
        <div class="code-with-filename lang-js">
        <p>tweet.gs</p>
        <div class="sourceCode" id="cb4" data-filename="tweet.gs"><pre
        class="sourceCode js:tweet.gs lang-js"><code class="sourceCode glsl"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>function <span class="fu">postTweetInThread</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> oauth2Service <span class="op">=</span> <span class="fu">getService2</span><span class="op">();</span> <span class="co">// v2のAPIを取得</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> preTweetId <span class="op">=</span> &#39;<span class="dv">1677260123981647872</span>&#39;<span class="op">;</span> <span class="co">// ポストされたツリー元のIDをいれる</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> text <span class="op">=</span> &#39;ツリー投稿&#39;<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  let payloadV2 <span class="op">=</span> <span class="op">{</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    text<span class="op">:</span> text<span class="op">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    reply<span class="op">:</span> <span class="op">{</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      &#39;in_reply_to_tweet_id&#39;<span class="op">:</span> preTweetId</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  let optionsV2 <span class="op">=</span> <span class="op">{</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    method<span class="op">:</span> &#39;POST&#39;<span class="op">,</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    payload<span class="op">:</span> JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">(</span>payloadV2<span class="op">),</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">:</span> <span class="op">{</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      &#39;Content<span class="op">-</span>Type&#39;<span class="op">:</span> &#39;application<span class="op">/</span>json&#39;<span class="op">,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      &#39;Authorization&#39;<span class="op">:</span> &#39;Bearer &#39; <span class="op">+</span> oauth2Service<span class="op">.</span><span class="fu">getAccessToken</span><span class="op">()</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  let responseV2 <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span><span class="op">(</span>TWITTER_API_ENDPOINT2<span class="op">,</span> optionsV2<span class="op">);</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  console<span class="op">.</span><span class="fu">log</span><span class="op">(</span>JSON<span class="op">.</span><span class="fu">parse</span><span class="op">(</span>responseV2<span class="op">.</span><span class="fu">getContentText</span><span class="op">()));</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
        </div>
        <p>ツリー投稿はv2のAPIのみでできます。おそらくツリー投稿をする際に最も迷うのはこの部分です。<code>in_reply_to_tweet_id</code>を使用します。</p>
        <div class="code-with-filename lang-js">
        <p>tweet.gs</p>
        <div class="sourceCode" id="cb5" data-filename="tweet.gs"><pre
        class="sourceCode js:tweet.gs lang-js"><code class="sourceCode glsl"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>let payloadV2 <span class="op">=</span> <span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  text<span class="op">:</span> text<span class="op">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  reply<span class="op">:</span> <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    &#39;in_reply_to_tweet_id&#39;<span class="op">:</span> preTweetId</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
        </div>
        <p>わかってしまえば簡単ですけど、当時はドキュメントも今一つで、いくつかのテストコードを書き、TwitterDevがGitHubで公開しているソースコードをあさって解決しました。</p>
        <p>もうひとつツリー投稿に必要なのは、ツリー元のIDです。元ポストの情報が必要になるため、IDをどこかに保存しておく必要があります。投稿がスプレッドシートで管理されているため、スプレッドシートを使ってIDを管理するのが素直でわかりやすいでしょう。ポスト後にIDを書き込んでいます。</p>
        <p>スケジュール情報が整理されるよう、UI的に前の行にツリーする形に限定してわかりやすくしています。</p>
        <h3
        id="日付一括変換機能の実装事例">「日付一括変換」機能の実装事例</h3>
        <p>ケーススタディとして「日付の一括変換」機能をブラッシュアップ事例を紹介しましょう。メニュー操作からスプレッドシートデータの書き込みするまでの流れです。</p>
        <p>初中級者向けの内容です。</p>
        <p>メニューの<code>SpreadsheetApp.getUi()</code>を通じてHTMLファイルのポップアップを呼び出し、そこで入力されたデータをサーバーサイドのコードに渡します。Html内の<code>google.script.run</code>でサーバーを呼び出します。このあたりのコードは初心者でも簡単です。</p>
        <div class="code-with-filename lang-js">
        <p>popup.html</p>
        <div class="sourceCode" id="cb6" data-filename="popup.html"><pre
        class="sourceCode js:popup.html lang-js"><code class="sourceCode djangotemplate"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">callServerFunction</span>() {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    google<span class="op">.</span><span class="at">script</span><span class="op">.</span><span class="at">run</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withSuccessHandler</span>(<span class="kw">function</span>(returnValue) {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 成功時の処理</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(returnValue)<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withFailureHandler</span>(<span class="kw">function</span>(error) {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// エラー時の処理</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(error)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">// サーバーにパラメーターを渡す</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">serverSideFunction</span>()<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/script&gt;</span></span></code></pre></div>
        </div>
        <p>最初は簡単な日付一括置換機能をつけてみました。</p>
        <p><img src="../theme/images/crafttwix15-2.png" /></p>
        <div class="code-with-filename lang-js">
        <p>menu.gs</p>
        <div class="sourceCode" id="cb7" data-filename="menu.gs"><pre
        class="sourceCode js:menu.gs lang-js"><code class="sourceCode glsl"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>function <span class="fu">shiftDates</span><span class="op">(</span>form<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> shiftDays <span class="op">=</span> form<span class="op">.</span><span class="fu">shiftDays</span><span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> sheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSpreadsheet</span><span class="op">().</span><span class="fu">getSheetByName</span><span class="op">(</span>&#39;schedule<span class="op">-</span>tweet&#39;<span class="op">);</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> values <span class="op">=</span> sheet<span class="op">.</span><span class="fu">getDataRange</span><span class="op">().</span><span class="fu">getValues</span><span class="op">();</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// 見出し行をスキップし、3行目から日付をシフト</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">for</span> <span class="op">(</span>let i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;</span> values<span class="op">.</span><span class="fu">length</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C列の日付を取得</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> dateString <span class="op">=</span> values<span class="op">[</span>i<span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">(</span>dateString<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">// 日付をシフト</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> date <span class="op">=</span> new <span class="fu">Date</span><span class="op">(</span>dateString<span class="op">);</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      date<span class="op">.</span><span class="fu">setDate</span><span class="op">(</span>date<span class="op">.</span><span class="fu">getDate</span><span class="op">()</span> <span class="op">+</span> <span class="fu">parseInt</span><span class="op">(</span>shiftDays<span class="op">));</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="co">// スプレッドシートのタイムゾーンを取得</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> timeZone <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSpreadsheet</span><span class="op">().</span><span class="fu">getSpreadsheetTimeZone</span><span class="op">();</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">// タイムゾーンを考慮して日付を設定</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> formattedDate <span class="op">=</span> Utilities<span class="op">.</span><span class="fu">formatDate</span><span class="op">(</span>date<span class="op">,</span> timeZone<span class="op">,</span> &#39;yyyy<span class="op">/</span>MM<span class="op">/</span>dd&#39;<span class="op">);</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>      sheet<span class="op">.</span><span class="fu">getRange</span><span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">).</span><span class="fu">setValue</span><span class="op">(</span>formattedDate<span class="op">);</span> <span class="co">// C列に設定</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
        </div>
        <p>アップデート時に次のように改良してみました。日にちや終了日にも対応しています。</p>
        <p>実装は簡単なものを作ったのち、徐々に拡張していく方法がおすすめです。</p>
        <p><img src="../theme/images/crafttwix15.png" /></p>
        <p>日付一括変換機能をアップデートした際に考えたことをご紹介します。</p>
        <ul>
        <li>日と時間の繰り上げ処理</li>
        <li>上限値以上を入力した場合、数字の書き換え</li>
        <li>空白対応</li>
        <li>バッチ処理による高速化</li>
        <li>範囲指定による高速化</li>
        <li>デザインの変更</li>
        <li>変換時のローディング処理</li>
        </ul>
        <p><code>sheet.getDataRange().getValues();</code>はシートの全体をチェックするため処理が遅いです。軽く実装したところ、動作がもっさりとしてしまったため、高速化をしなければいけませんでした。</p>
        <p>「範囲指定による高速化」と「バッチ処理による高速化」の2点で対応しました。</p>
        <p>スプレッドシートの範囲を指定して必要な部分だけをチェックすることで速くなります。また、バッチ処理による高速化は書き込みを一度に行うものです。毎回、書き込むのではなく配列にデータを入れて、最後に一度だけ書き込みます。</p>
        <p>完成したコードは変更される可能性があるため、GASのコードを確認してください。</p>
        <p>開発現場で何日も高速化に取り組むプログラマをよく見てきました。動作するコードが書けたら、初心者エンジニアの方はもう少し高速化できないか考えてみるといいでしょう。</p>
        <p>それでもUIデザインは変換時に時間がかかる場合、ローディング処理が欲しいです。ボタンを押して反応がないと固まっているように見えるからです。ローディング処理のようなフィードバックは、ユーザーがシステムが応答していることを知るのに役立ちます。</p>
        <p>プログラミングとデザインの支え合いによっていいツールになっていきます。簡単ではありますが、何か得るものがあれば幸いです。</p>
        <h2 id="最後に">最後に</h2>
        <p>基本的には、コードを参照してもらえますようお願いします。</p>
        <h3
        id="初心者すぎてコードがわからない">初心者すぎてコードがわからない</h3>
        <p>自分でコードを読むことも大事ですが、わからないコードはChatGPT君(GPT4がおすすめ)に解説してもらうと理解が早いでしょう。プログラミングの教材なみの解説をしてもらえるはずです。AIの登場によって教育も激変してくる気がします。</p>
        <p>ただし、時折、ChatGPTが間違ったことをもっともらしく返してくることがあります。そのため、回答に違和感を感じたり、自分自身がよく理解していなかったりする場合は、検索エンジンを併用することをおすすめします。特にプログラミング初心者の方は、他のサイトで学習した内容をネタにChatGPTと会話するとよいでしょう。自分自身の知識が増えれば増えるほど、ChatGPTの能力を引きだせます。</p>
        <p>問題点は細かく因数分解していくと、問題点が絞られてわかるようになります。関数ごとにconsole.logを入れて値を監視することで、理解が深まるでしょう。それでも、わからない場合は、GASなのでJavaScriptの基礎などを学習して戻ってきてください。</p>
        <h3 id="バグ報告歓迎">バグ報告歓迎</h3>
        <p>「思っていたより簡単すぎた」とか、「もっとこうしたいいいんじゃないか」という中・上級者のご意見もあるかもしれません。改変は自由なので修正したい箇所があれば自由に手を加えてください。転売・転載なしなら、必要なコードを拾って新規プロジェクトで作ってもかまいません。</p>
        <p>バグ等はこちらでもいくつか把握しており時間を見つけて随時修正していきますが、バグ報告は歓迎しますので、もしよろしければこっそりと教えてもらえるとありがたいです。</p>
        <p>至らない点もあるかと思いますが、今後もソースコードはブラッシュアップをしていく所存です。</p>
              </div>
      <div id="sidebar-div" class="sidebar">
        <div class="sidebar-book-title">
          <div class="sideber-book-symbol">
            <img width="100%" height="100%" src="../theme/anime/crafttwit-particle.webp" alt="">
          </div>
          <div class="sideber-book-text-image">
            <svg width="100%" height="100%" viewBox="0 0 1791 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/">
              <g transform="matrix(1,0,0,1,-51,-473)">
                  <g transform="matrix(1.2249,2.20465e-34,0,1.2249,-215.908,39.3221)">
                      <g id="craft-twix-logo" transform="matrix(1,-1.09826e-50,0,1,118.292,20.3212)">
                          <g transform="matrix(1,-3.23647e-50,0,1,-373.292,67.7606)">
                              <path d="M1901.71,343.496C1901.21,343.496 1900.96,343.496 1900.96,343.746C1892.46,353.246 1866.46,376.996 1857.46,386.246C1848.21,376.746 1822.71,354.996 1810.71,344.996C1810.46,344.746 1810.21,344.746 1809.71,344.746L1809.21,344.746C1803.21,348.246 1792.96,358.496 1787.71,364.496C1787.46,364.996 1787.21,364.996 1787.21,365.246C1787.21,365.496 1787.21,365.746 1787.71,365.996C1802.96,379.996 1826.96,396.746 1836.71,406.246C1827.71,415.746 1798.21,434.746 1784.96,444.246C1784.71,444.496 1784.46,444.996 1784.46,445.496C1784.46,445.746 1784.46,445.996 1784.71,446.246C1789.46,452.496 1801.71,462.496 1809.21,468.746C1809.46,468.996 1809.96,469.246 1810.21,469.246C1810.71,469.246 1811.21,468.996 1811.46,468.746C1821.21,459.996 1841.46,442.996 1859.46,424.746C1874.21,438.996 1893.71,455.246 1906.46,468.496C1906.96,468.996 1907.71,469.746 1908.46,469.746C1908.71,469.746 1908.96,469.496 1909.21,469.496C1916.46,465.996 1928.71,452.746 1934.21,447.746C1934.46,447.496 1934.71,446.996 1934.71,446.496C1934.71,446.246 1934.71,445.996 1934.46,445.996C1920.21,434.746 1892.46,414.746 1878.21,402.996C1890.21,392.246 1914.21,377.996 1926.21,365.746C1926.71,365.246 1927.21,364.246 1927.21,363.496C1927.21,363.246 1927.21,362.996 1926.96,362.746C1919.71,355.746 1910.96,347.746 1902.46,343.496L1901.71,343.496Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-374.108,67.7606)">
                              <path d="M1764.46,350.746C1755.71,351.746 1733.21,353.496 1731.46,353.746C1730.21,353.996 1730.21,354.246 1730.21,355.246C1731.21,369.746 1731.71,383.996 1731.71,398.246C1731.71,420.496 1730.46,442.996 1728.71,465.496C1728.71,466.746 1728.96,466.746 1729.96,466.746C1736.96,466.746 1758.96,464.996 1765.21,464.496C1765.96,464.496 1766.46,463.496 1766.46,462.996C1765.46,441.496 1764.71,420.246 1764.71,398.746C1764.71,383.246 1764.96,367.496 1766.21,351.996C1766.21,351.246 1765.71,350.746 1764.96,350.746L1764.46,350.746ZM1765.71,311.746C1757.21,312.746 1732.46,314.746 1730.71,314.996C1729.46,315.246 1729.46,315.246 1729.46,316.246C1729.96,322.746 1730.21,330.996 1730.46,337.996C1730.46,339.246 1730.71,339.246 1731.71,339.246C1738.71,338.746 1758.96,336.496 1764.96,335.996C1765.96,335.996 1766.21,334.996 1766.21,334.246C1766.46,326.246 1767.46,318.996 1767.71,313.246C1767.71,312.496 1766.96,311.746 1766.21,311.746L1765.71,311.746Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-368.393,67.7606)">
                              <path d="M1705.46,354.996C1705.46,354.496 1705.21,354.246 1704.71,354.246C1697.46,352.996 1676.71,350.996 1670.46,349.996C1669.71,349.996 1669.21,350.496 1669.21,350.746C1665.46,365.246 1656.96,394.246 1654.46,407.246C1653.46,411.996 1650.71,416.746 1649.21,421.746C1646.46,415.746 1646.71,414.246 1644.71,407.496C1640.21,392.246 1630.71,366.246 1626.21,351.496C1625.96,351.246 1625.71,350.996 1625.21,350.996L1624.71,350.996C1618.96,352.246 1604.96,354.496 1594.21,355.996C1593.21,356.246 1592.71,356.996 1592.46,357.996C1588.71,372.746 1576.46,403.996 1574.96,411.246C1573.71,416.996 1571.46,422.746 1568.96,428.496C1567.71,422.496 1567.21,415.996 1566.46,411.246C1564.21,398.996 1554.21,363.496 1550.96,350.746C1550.71,349.746 1549.96,349.746 1548.46,349.746C1542.21,349.746 1525.71,352.246 1517.71,353.496C1516.96,353.746 1516.71,353.996 1516.71,354.246L1516.71,354.746C1523.71,376.246 1538.46,419.996 1544.21,437.996C1547.96,449.246 1549.21,457.496 1551.21,465.746L1551.21,465.996C1551.21,466.246 1551.46,466.496 1552.46,466.496C1560.46,466.246 1578.71,463.746 1584.71,463.246L1585.71,463.246C1585.71,463.246 1585.96,462.996 1585.96,462.746C1590.71,448.246 1602.21,422.246 1605.96,409.996C1607.46,404.996 1608.46,398.996 1610.21,395.246C1611.46,397.996 1613.21,407.246 1614.21,410.246C1620.46,428.496 1629.71,452.496 1632.46,463.996C1632.71,464.996 1633.71,466.246 1635.46,466.246C1643.71,465.996 1657.21,464.746 1664.96,464.496C1665.96,464.496 1666.46,463.496 1666.71,462.996C1668.71,455.246 1671.71,446.496 1676.21,435.496C1682.21,420.746 1698.21,373.746 1705.46,355.496L1705.46,354.996Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-369.21,67.7606)">
                              <path d="M1389.71,467.996C1397.96,467.996 1417.71,466.496 1423.46,465.996C1424.21,465.996 1424.71,464.746 1424.71,464.246C1423.71,442.996 1423.21,421.746 1423.21,400.496C1423.21,380.496 1423.71,360.746 1424.71,340.746C1452.96,341.746 1466.96,343.496 1484.46,347.246C1485.21,347.246 1485.71,347.496 1486.46,347.496C1486.96,347.496 1487.71,347.246 1488.71,346.246C1494.96,339.746 1496.46,326.746 1500.21,316.496L1500.21,315.996C1500.21,314.996 1499.21,314.246 1497.96,314.246L1490.46,314.246C1455.46,314.246 1420.71,312.246 1385.71,312.246C1366.46,312.246 1347.46,312.996 1328.21,314.746C1326.71,314.996 1325.96,316.746 1325.46,318.496C1324.71,321.496 1318.21,341.996 1317.46,343.746C1317.21,344.246 1317.21,344.496 1317.21,344.996C1317.21,345.746 1317.71,345.996 1318.71,345.996L1319.46,345.996C1340.46,341.746 1361.96,340.246 1390.96,339.996C1391.21,348.246 1391.21,356.746 1391.21,365.496C1391.21,399.246 1389.96,434.496 1386.96,466.996L1386.96,467.496C1386.96,467.996 1387.21,467.996 1387.46,467.996L1389.71,467.996Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-341.452,67.7606)">
                              <path d="M1219.21,437.496C1219.21,436.496 1218.46,435.996 1217.46,435.996C1211.71,436.746 1206.46,436.996 1201.96,436.996C1183.46,436.996 1172.46,431.496 1172.46,419.496L1172.46,418.746C1172.71,411.996 1172.71,394.746 1173.21,376.746C1192.71,376.746 1208.96,376.996 1213.71,377.996L1214.21,377.996C1214.96,377.996 1216.21,377.496 1217.21,375.996C1221.21,369.996 1222.46,357.496 1224.46,351.996L1224.46,351.746C1224.46,350.996 1223.71,350.246 1222.96,350.246L1173.71,350.246C1174.46,328.746 1174.96,315.496 1175.21,312.746C1175.21,311.996 1175.21,311.996 1174.71,311.996L1173.96,311.996C1164.71,313.246 1150.46,313.996 1140.21,315.246C1139.46,315.496 1138.71,315.746 1138.71,316.496L1138.71,316.996C1139.46,324.746 1139.96,334.246 1140.21,350.746C1121.46,351.246 1105.96,351.746 1102.21,351.996C1101.21,352.246 1100.46,352.746 1100.21,353.496C1098.71,356.996 1094.96,369.996 1092.71,377.746L1092.71,378.496C1092.71,379.246 1092.96,379.496 1093.71,379.496L1094.21,379.496C1101.71,378.996 1119.96,377.996 1140.21,377.496C1140.21,386.996 1140.46,393.496 1140.46,400.246C1140.46,405.246 1140.21,410.496 1139.96,416.996L1139.96,421.496C1139.96,457.496 1161.21,466.996 1206.71,469.746C1207.96,469.746 1208.96,468.996 1209.21,468.246C1213.21,457.996 1217.71,446.496 1219.21,437.996L1219.21,437.496Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-346.351,67.7606)">
                              <path d="M1070.21,393.746C1071.21,393.746 1072.21,393.246 1073.21,391.746C1077.21,385.746 1077.71,372.996 1079.71,367.496L1079.71,367.246C1079.71,366.496 1078.96,365.746 1078.21,365.746C1071.96,365.496 1047.21,365.246 1021.96,364.996C1022.21,357.746 1022.21,354.746 1022.21,353.496C1022.21,345.746 1037.71,340.496 1059.71,340.496C1063.21,340.496 1066.96,340.746 1070.71,340.996C1071.71,340.996 1072.21,340.496 1072.21,339.496C1070.21,328.746 1067.21,315.246 1065.71,310.496C1065.21,309.496 1064.96,309.496 1063.71,309.496C1024.21,309.996 992.458,321.996 992.458,345.746C992.458,350.246 992.208,355.246 991.958,364.746C975.958,364.746 963.208,364.996 959.708,365.246C958.958,365.246 958.208,365.996 957.958,366.746C956.458,370.496 954.208,383.246 950.958,391.246C950.958,391.496 950.708,391.746 950.708,391.996C950.708,392.746 951.208,392.996 952.208,392.996L952.708,392.996C959.208,392.496 973.958,391.996 990.708,391.746C989.458,418.996 987.708,447.746 986.208,464.996C986.208,466.246 986.458,466.246 987.708,466.246C994.458,466.246 1015.71,464.496 1021.71,463.996C1022.71,463.996 1023.21,462.996 1023.21,462.496C1022.21,436.746 1021.71,408.746 1021.71,391.746C1044.21,391.746 1064.21,392.496 1069.71,393.746L1070.21,393.746Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-348.8,67.7606)">
                              <path d="M852.958,441.496C835.708,440.746 818.708,432.746 817.958,412.496L817.958,411.246C817.958,392.246 835.708,378.996 853.208,378.996C865.458,378.996 875.458,383.496 880.708,392.746C880.958,393.246 881.208,393.746 881.708,393.746C882.208,393.746 882.458,393.496 883.208,392.996C883.958,392.496 893.458,379.246 893.958,379.246C893.958,388.246 893.958,406.746 893.458,424.496C884.708,435.246 870.208,441.496 855.458,441.496L852.958,441.496ZM851.208,470.246C871.208,469.996 884.208,465.746 891.708,459.496C893.458,465.246 899.708,470.246 907.958,474.246C908.458,474.496 909.458,474.496 910.458,474.496C911.458,474.496 912.458,474.496 912.958,474.246C920.708,469.496 931.708,458.496 937.208,449.996C937.458,449.496 937.458,449.246 937.458,448.996C937.458,448.746 937.458,448.746 936.958,448.496C928.708,445.746 923.958,443.996 923.708,438.246C922.958,425.496 922.708,410.996 922.708,397.996C922.708,386.496 922.958,376.246 923.458,369.496C923.708,366.996 926.208,356.746 927.958,346.496C927.958,345.746 926.708,344.996 925.958,344.996L896.708,344.996C895.458,344.996 895.208,346.496 894.958,347.496C894.208,350.746 894.458,355.246 893.458,362.496C887.458,355.996 871.708,349.496 857.208,349.496C855.958,349.496 854.708,349.746 853.458,349.746C815.708,352.496 784.208,375.746 784.208,412.996C784.208,446.246 816.708,470.246 850.708,470.246L851.208,470.246Z"/>
                          </g>
                          <g transform="matrix(1,-3.23647e-50,0,1,-352.065,67.7606)">
                              <path d="M771.958,359.746C771.958,359.246 771.458,358.996 770.708,358.746C756.208,356.246 738.958,350.996 718.458,350.996C714.208,350.996 709.958,351.246 705.458,351.746C694.708,352.996 679.458,362.746 673.458,369.746C673.708,364.496 674.458,357.496 674.958,352.246C674.958,351.246 674.208,350.746 672.958,350.746C664.208,351.246 643.458,352.246 639.708,352.996C638.458,353.246 638.458,353.496 638.458,354.246C639.708,372.996 640.458,390.996 640.458,408.996C640.458,427.746 639.708,446.246 637.958,465.746C637.958,466.746 638.208,466.746 638.458,466.746L640.708,466.746C648.708,466.746 668.958,464.996 674.708,464.746C675.708,464.496 676.208,463.496 676.208,462.996C674.458,441.246 671.708,419.246 671.708,397.496C671.708,392.746 671.958,388.246 672.208,383.496C674.208,386.246 679.458,391.996 680.958,393.746C681.708,394.496 682.208,394.996 682.708,394.996C683.208,394.996 683.708,394.746 683.958,393.996C688.208,385.496 694.708,379.746 706.458,379.246L708.458,379.246C725.958,379.246 743.958,389.246 753.458,393.496C753.708,393.746 753.958,393.746 754.458,393.746C755.208,393.746 756.458,393.246 757.208,392.246C762.708,384.496 768.708,367.746 771.958,360.246L771.958,359.746Z"/>
                          </g>
                          <g transform="matrix(1,-1.09826e-50,0,1,-351.249,67.7606)">
                              <path d="M619.708,335.246C619.708,334.996 619.458,334.996 619.208,334.746C598.958,319.746 574.208,308.996 548.708,308.996C498.958,308.996 451.208,336.496 451.208,391.246C451.208,448.496 498.208,470.496 549.208,470.496C560.708,470.496 614.708,461.246 616.708,446.996C616.958,445.746 616.958,443.996 616.958,441.996C616.958,434.246 615.958,421.746 614.708,416.996C614.458,416.246 613.958,414.746 612.708,414.746C612.458,414.746 612.208,414.746 611.958,414.996C597.958,428.496 578.208,441.746 548.208,441.746C515.958,441.746 486.708,428.246 486.708,391.996C486.708,359.246 514.958,340.996 545.208,340.246L547.208,340.246C570.458,340.246 582.208,348.746 599.208,362.996C599.458,363.246 599.708,363.246 599.958,363.246C600.208,363.246 600.458,363.246 600.708,362.996C607.958,356.746 615.958,344.746 619.708,335.746L619.708,335.246Z"/>
                          </g>
                          <g transform="matrix(1,-1.09826e-50,0,1,-118.292,-20.3212)">
                              <path d="M278.995,458.606L288.553,448.074L326.504,481.104L315.809,492.762L278.995,458.606Z"/>
                              <path d="M299.35,487.517L304.962,493.268L350.311,446.245L345.4,441.342L299.35,487.517Z"/>
                          </g>
                          <g transform="matrix(1,-1.09826e-50,0,1,-139.719,-12.3954)">
                              <path d="M1106.17,420.885C1116.49,435.805 1145.44,448.276 1169.07,448.276C1198.58,448.275 1213.9,445.318 1231.62,431.134C1249.34,416.95 1240.42,411.321 1226.49,417.914C1212.57,424.506 1184.06,438.168 1167.27,435.761C1130.79,430.531 1132.32,427.004 1118.44,413.876C1113.59,409.28 1098.26,409.426 1106.17,420.885Z"/>
                          </g>
                          <g transform="matrix(0.729955,-5.75219e-51,0,0.729955,206.372,75.0805)">
                              <g transform="matrix(1.19281,0,0,1.19281,-222.377,-41.9313)">
                                  <path d="M1148.83,368.044L1120.01,379.244C1120.01,379.244 1121.85,391.936 1135.49,397.102C1155.02,404.505 1184.42,396.732 1191.41,378.697C1193.85,372.405 1148.83,368.044 1148.83,368.044Z"/>
                              </g>
                              <g transform="matrix(1.19281,0,0,1.19281,-140.339,-36.8696)">
                                  <circle cx="1101.52" cy="356.45" r="27.447"/>
                              </g>
                              <g transform="matrix(1,0,0,1,-17.2449,0.229812)">
                                  <path d="M1209.28,364.935C1210.48,365.218 1236.63,358.739 1239.43,355.241C1241.87,352.198 1229.11,372.937 1222.19,377.912C1219.74,379.669 1234.99,375.799 1243.12,372.929C1244.34,372.497 1228.97,389.774 1223.91,394.669C1221.58,396.918 1208.08,364.651 1209.28,364.935Z"/>
                              </g>
                          </g>
                      </g>
                  </g>
              </g>
            </svg>
          </div>
          <div class="author-wrap">
                      </div>
          <!--  -->
        </div>
        <nav>
          <ul class="color-menu color-menu-sidebar">
            <li>
              <label for="set-day-theme-sidebar">
                <input type="checkbox" id="set-day-theme-sidebar" onclick="changeDaymode();" value="">
                <div class="icon-btn">
                  <div>
                    <svg x="50%" y="50%" width="75%" height="75%" viewBox="0 0 600 600">
                      <defs>
                        <lineargradient id="dayBtnGradientSidebar" gradientTransform="rotate(45)">
                          <stop offset="5%"  stop-color="#f8d661"></stop>
                          <stop offset="95%" stop-color="#e56376"></stop>
                        </lineargradient>
                      </defs>
                      <g transform="matrix(1,0,0,1,-7374,-2500)" fill="url('#dayBtnGradientSidebar')">
                          <g transform="matrix(1,0,0,1,-0.0555556,0)">
                              <g transform="matrix(1.15385,0,0,1.15385,-1238.25,-419.231)">
                                  <circle cx="7724" cy="2790" r="130"/>
                              </g>
                              <g>
                                  <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                              </g>
                              <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4874.06)">
                                  <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                              </g>
                              <g transform="matrix(-1,-1.22465e-16,1.22465e-16,-1,15348.1,5600)">
                                  <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                              </g>
                              <g transform="matrix(6.12323e-17,-1,1,6.12323e-17,4874.06,10474.1)">
                                  <g transform="matrix(1,0,0,1,-29.9444,8.56204e-12)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(0.707107,0.707107,-0.707107,0.707107,4218.27,-4639.32)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                                  <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,10474.1,-4903)">
                                      <path d="M7734,2515C7734,2506.72 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2506.72 7674,2515L7674,2605C7674,2613.28 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2613.28 7734,2605L7734,2515Z"/>
                                  </g>
                              </g>
                          </g>
                      </g>
                    </svg>  
                  </div>
                </div>
                <div>
                  Day
                </div>
              </label>
            </li>
            <li>
              <label for="set-night-theme-sidebar">
                <input type="checkbox" id="set-night-theme-sidebar" onclick="changeDarkmode();" value="">
                <div class="icon-btn"><div>
                <svg x="50%" y="50%" width="75%" height="75%" viewBox="0 0 579 550">
                  <defs>
                    <lineargradient id="nightBtnGradientSidebar" gradientTransform="rotate(45)">
                      <stop offset="5%"  stop-color="#6275e0"></stop>
                      <stop offset="95%" stop-color="#6e51A4"></stop>
                    </lineargradient>
                  </defs>
                  <g transform="matrix(1,0,0,1,-6681,-2529)" fill="url('#nightBtnGradientSidebar')">
                    <g transform="matrix(1,0,0,1,-0.0555556,0)">
                      <g transform="matrix(1.11529,0,0,1.11529,-917.771,-209.044)">
                        <path d="M7072.5,2455L7170.81,2592.19L7331.66,2643.29L7231.57,2779.18L7232.67,2947.96L7072.5,2894.75L6912.33,2947.96L6913.43,2779.18L6813.34,2643.29L6974.19,2592.19L7072.5,2455Z"/>
                      </g>
                    </g>
                  </g>
                </svg>  
                </div></div>
                <div>
                  Night
                </div>
              </label>
            </li>
            <li>
              <label for="set-sepia-theme-sidebar">
                <input type="checkbox" id="set-sepia-theme-sidebar" onclick="changeSepiamode();" value="">
                <div class="icon-btn"><div>
                  <svg x="50%" y="50%" width="75%" height="75%" viewBox="0 0 635 600">
                    <defs>
                      <lineargradient id="memoryBtnGradientSideber" gradientTransform="rotate(45)">
                        <stop offset="5%"  stop-color="#dac96d"></stop>
                        <stop offset="95%" stop-color="#f3eacb"></stop>
                      </lineargradient>
                    </defs>
                    <g transform="matrix(1,0,0,1,-8139,-2500)">
                        <g transform="matrix(1,0,0,1,-0.0555556,0)" fill="url('#memoryBtnGradientSideber')">
                            <g transform="matrix(-0.01406,0.123333,-1.93818,-0.220953,14953,2598.21)">
                                <path d="M7374,3433.61L7374,3425.39L7661.21,3425.39L7661.21,3400L8274,3429.5L7661.21,3459L7661.21,3433.61L7374,3433.61Z"/>
                            </g>
                            <g transform="matrix(-0.708237,-0.705975,0.705975,-0.708237,12004.7,11261.3)">
                                <path d="M8548.67,3209.44C8524.27,3203.17 8499.19,3200 8474,3200C8308.42,3200 8174,3334.43 8174,3500C8174,3665.58 8308.42,3800 8474,3800C8639.58,3800 8774,3665.58 8774,3500C8774,3420.43 8742.39,3344.13 8686.13,3287.87L8651.57,3322.43C8698.66,3369.53 8725.12,3433.4 8725.12,3500C8725.12,3638.6 8612.6,3751.12 8474,3751.12C8335.4,3751.12 8222.88,3638.6 8222.88,3500C8222.88,3361.4 8335.4,3248.88 8474,3248.88C8495.08,3248.88 8516.08,3251.54 8536.5,3256.78L8548.67,3209.44Z"/>
                            </g>
                            <g transform="matrix(1,0,1.2326e-32,1.5,767.056,-1150.5)">
                                <path d="M7734,2510C7734,2504.48 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2504.48 7674,2510L7674,2610C7674,2615.52 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2615.52 7734,2610L7734,2510Z"/>
                            </g>
                            <g transform="matrix(-0.551323,0.834292,-1.25144,-0.826985,16039.3,-1441.44)">
                                <path d="M7734,2510C7734,2504.48 7727.28,2500 7719,2500L7689,2500C7680.72,2500 7674,2504.48 7674,2510L7674,2610C7674,2615.52 7680.72,2620 7689,2620L7719,2620C7727.28,2620 7734,2615.52 7734,2610L7734,2510Z"/>
                            </g>
                        </g>
                    </g>
                  </svg>  
                </div></div>
                <div>
                  Sepia
                </div>
              </label>
            </li>
          </ul>
        </nav> 

        <div class="sidebar-menu-link">
          <a href="https://ebookbrain.booth.pm/items/4941730">
            <div class="square-btn">
              Update
            </div>
          </a>
          <a href="https://ebookbrain.net/ebook-and-tool-collection-available-on-ebookbrain/">
            <div class="square-btn">
              News
            </div>
          </a>
        </div>

        <div class="toc-menu">
          <div class="tab-wrap">
            <input id="tab-toc" type="radio" name="tab" class="tab-switch" checked="checked" />
            <input id="tab-chapter" type="radio" name="tab" class="tab-switch" />

            <div class="tab-item-wrap">
              <label class="tab-label tab-label-toc" for="tab-toc">Toc</label>
              <label class="tab-label tab-label-chapter" for="tab-chapter">Chapter</label>
            </div>

            <div class="tab-content tab-content-toc">
              <div class="tab-content-layout">
                <a href="#"><div class="pagetop-btn">Page Top</div></a>
                <div id="indexList">
                  <nav id="TOC" class="index space" role="doc-toc">
                    <ul>
                    <li><a href="#最初に"
                    id="toc-最初に">最初に</a></li>
                    <li><a href="#ファイル解説"
                    id="toc-ファイル解説">ファイル解説</a>
                    <ul>
                    <li><a href="#debug-utils.js"
                    id="toc-debug-utils.js">debug-utils.js</a></li>
                    <li><a href="#spreadsheet-helpers.js"
                    id="toc-spreadsheet-helpers.js">spreadsheet-helpers.js</a></li>
                    <li><a href="#menu.js"
                    id="toc-menu.js">menu.js</a></li>
                    <li><a href="#tweet.js"
                    id="toc-tweet.js">tweet.js</a></li>
                    <li><a href="#fetch-wp-posts.js"
                    id="toc-fetch-wp-posts.js">fetch-wp-posts.js</a></li>
                    <li><a href="#fetch-wp-categories.js"
                    id="toc-fetch-wp-categories.js">fetch-wp-categories.js</a></li>
                    </ul></li>
                    <li><a href="#開発環境"
                    id="toc-開発環境">開発環境</a></li>
                    <li><a href="#トラブルシューティング"
                    id="toc-トラブルシューティング">トラブルシューティング</a>
                    <ul>
                    <li><a href="#読み取り専用エディタは編集できません"
                    id="toc-読み取り専用エディタは編集できません">読み取り専用エディタは編集できません</a></li>
                    </ul></li>
                    <li><a href="#プログラミング解説"
                    id="toc-プログラミング解説">プログラミング解説</a>
                    <ul>
                    <li><a href="#文字数のカウント"
                    id="toc-文字数のカウント">文字数のカウント</a></li>
                    <li><a href="#画像投稿1枚のサンプル"
                    id="toc-画像投稿1枚のサンプル">画像投稿1枚のサンプル</a></li>
                    <li><a href="#ツリー投稿のサンプル"
                    id="toc-ツリー投稿のサンプル">ツリー投稿のサンプル</a></li>
                    <li><a href="#日付一括変換機能の実装事例"
                    id="toc-日付一括変換機能の実装事例">「日付一括変換」機能の実装事例</a></li>
                    </ul></li>
                    <li><a href="#最後に" id="toc-最後に">最後に</a>
                    <ul>
                    <li><a href="#初心者すぎてコードがわからない"
                    id="toc-初心者すぎてコードがわからない">初心者すぎてコードがわからない</a></li>
                    <li><a href="#バグ報告歓迎"
                    id="toc-バグ報告歓迎">バグ報告歓迎</a></li>
                    </ul></li>
                    </ul>
                  </nav>
                </div>
              </div>
            </div>
            <div class="tab-content tab-content-chapter">
              <div class="tab-content-layout chapter-toc">
                <ul>
                  <li><a href="./1-twitter-api.html">Twitter APIの取得</a></li>
                  <li><a href="./2-crafttwix-usage.html">Craft Twixの使い方(予約投稿編)</a></li>
                  <li><a href="./3-crafttwix-usage-images-videos.html">Craft Twixの使い方(画像・動画管理編)</a></li>
                  <li><a href="./4-wp-api.html">WordPress APIの取得</a></li>
                  <li><a href="./5-crafttwix-usage-for-wp.html">Craft Twixの使い方(WordPress編)</a></li>
                  <li><a href="./6-spreadsheet-tips.html">スプレットシートの使い方TIPS(ノンプログラマー向け)</a></li>
                  <li><a href="./7-program-tips.html">プログラミングTIPS(エンジニア向け)</a></li>
                  <li><a href="./8-colophon.html">あとがき</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

<script src="../theme/js/theme.js"></script>
<script src="../theme/js/toc-with-scrolling-active-states.js"></script>
<script src="../theme/js/fixed-tabs.js"></script>
</body>
</html>
